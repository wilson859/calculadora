import pandas as pd

def realizar_operacion(row):
    """Realiza la operación matemática especificada en la fila.

    Args:
        row: Una serie de pandas que representa una fila del DataFrame.

    Returns:
        El resultado de la operación o un mensaje de error si la operación no es válida.
    """

    operacion = row['operation']
    operando1 = row['operand_1']
    operando2 = row['operand_2']

    try:
        if operacion == 'SUM':
            return operando1 + operando2
        elif operacion == 'RESTA':
            return operando1 - operando2
        elif operacion == 'MULTIPLICACION':
            return operando1 * operando2
        elif operacion == 'DIVISION':
            if operando2 == 0:
                return "División por cero"
            else:
                return operando1 / operando2
        elif operacion == 'POTENCIA':
            return operando1 ** operando2
        else:
            return "Operación no válida"
    except TypeError:
        return "Error de tipo de dato"

# Cargar el archivo CSV
df = pd.read_csv("operaciones.csv")

# Aplicar la función a cada fila y crear una nueva columna
df['resultado'] = df.apply(realizar_operacion, axis=1)

# Crear una columna para indicar si la operación fue exitosa
df['exito'] = df['resultado'].apply(lambda x: 'Sí' if isinstance(x, (int, float)) else 'No')

# Guardar los cambios en un nuevo archivo CSV
df.to_csv("operaciones_modificado.csv", index=False)

print("Archivo CSV modificado generado correctamente.")
